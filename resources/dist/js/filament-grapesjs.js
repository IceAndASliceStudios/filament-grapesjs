document.addEventListener("alpine:init",()=>{Alpine.data("grapesjs",({state:d,statePath:k,readOnly:E,tools:h,minHeight:j,container:u,plugins:v,settings:g})=>({instance:null,state:d,tools:h,plugins:v,settings:g,init(){let A={},w={height:j+"px",container:u||".filament-grapesjs .grapesjs-wrapper",showOffsets:!0,fromElement:!0,noticeOnUnload:!1,storageManager:!1,loadHtml:d,plugins:v,selectorManager:{escapeName:t=>t},...g};var e=grapesjs.init(w),s=e.Panels,P=e.Modal,S=e.Commands;S.add("canvas-clear",function(){confirm("Are you sure to clean the canvas?")&&(e.runCommand("core:canvas-clear"),setTimeout(function(){localStorage.clear()},0))}),[["sw-visibility","Show Borders"],["preview","Preview"],["fullscreen","Fullscreen"],["export-template","Export"],["undo","Undo"],["redo","Redo"],["gjs-open-import-webpage","Import"],["canvas-clear","Clear canvas"]].forEach(function(t){btn=s.getButton("options",t[0]),btn&&btn.set("attributes",{title:t[1],"data-tooltip-pos":"bottom"})}),[["open-sm","Style Manager"],["open-layers","Layers"],["open-blocks","Blocks"]].forEach(function(t){s.getButton("views",t[0]).set("attributes",{title:t[1],"data-tooltip-pos":"bottom"})});for(var m=document.querySelectorAll("*[title]"),r=0;r<m.length;r++){var l=m[r],o=l.getAttribute("title");if(o=o?o.trim():"",!o)break;l.setAttribute("data-tooltip",o),l.setAttribute("title","")}e.on("storage:load",function(t){console.log("Loaded ",t)}),e.on("storage:store",function(t){console.log("Stored ",t)}),e.on("load",function(){var t=grapesjs.$,a=document.querySelector("[id='something']")??null,i=a.value;e.setStyle(i),s.getButton("options","sw-visibility").set({command:"core:component-outline",active:!0});var n=s.getButton("views","open-tm");n&&n.set("active",1);var f=s.getButton("views","open-sm");f&&f.set("active",1),s.removeButton("views","open-tm");var c=t('<div class="gjs-sm-sector no-select"><div class="gjs-sm-sector-title"><span class="icon-settings fa fa-cog"></span> <span class="gjs-sm-sector-label">Settings</span></div><div class="gjs-sm-properties" style="display: none;"></div></div>'),b=c.find(".gjs-sm-properties");b.append(t(".gjs-traits-cs")),t(".gjs-sm-sectors").before(c),c.find(".gjs-sm-sector-title").on("click",function(){var p=b.get(0).style,B=p.display=="none";B?p.display="block":p.display="none"});var y=e.Panels.getButton("views","open-blocks");y&&y.set("active",1)}),e.on("update",t=>{console.log("update",t);var a=document.querySelector("[id='something']")??null;a&&(a.value=e.getCss(),a.dispatchEvent(new Event("input")));var i=e.getHtml({cleanId:!0}),n=i.match(/<body\b[^>]*>([\s\S]*?)<\/body>/);n?this.state=n[1]:this.state=e.getHtml()})}}))});
