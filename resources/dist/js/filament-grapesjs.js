document.addEventListener("alpine:init",()=>{Alpine.data("grapesjs",({state:d,statePath:k,readOnly:A,tools:j,minHeight:B,container:p,plugins:m,settings:u})=>({instance:null,state:d,tools:j,plugins:m,settings:u,init(){let C={},w={height:B+"px",container:p||".filament-grapesjs .grapesjs-wrapper",showOffsets:!0,fromElement:!0,noticeOnUnload:!1,storageManager:!1,loadHtml:d,plugins:m,...u};this.instance=grapesjs.init(w);var e=this.instance.Panels,o=this.instance.Modal,g=this.instance.Commands;g.add("canvas-clear",function(){confirm("Are you sure to clean the canvas?")&&(this.instance.runCommand("core:canvas-clear"),setTimeout(function(){localStorage.clear()},0))});var v="gjs-mdl-dialog-sm",f=document.getElementById("info-panel");g.add("open-info",function(){var t=document.querySelector(".gjs-mdl-dialog");t.className+=" "+v,f.style.display="block",o.setTitle("About this demo"),o.setContent(f),o.open(),o.getModel().once("change:open",function(){t.className=t.className.replace(v,"")})}),e.addButton("options",{id:"open-info",className:"fa fa-question-circle",command:function(){this.instance.runCommand("open-info")},attributes:{title:"About","data-tooltip-pos":"bottom"}}),[["sw-visibility","Show Borders"],["preview","Preview"],["fullscreen","Fullscreen"],["export-template","Export"],["undo","Undo"],["redo","Redo"],["gjs-open-import-webpage","Import"],["canvas-clear","Clear canvas"]].forEach(function(t){btn=e.getButton("options",t[0]),btn&&btn.set("attributes",{title:t[1],"data-tooltip-pos":"bottom"})}),[["open-sm","Style Manager"],["open-layers","Layers"],["open-blocks","Blocks"]].forEach(function(t){e.getButton("views",t[0]).set("attributes",{title:t[1],"data-tooltip-pos":"bottom"})});for(var b=document.querySelectorAll("*[title]"),i=0;i<b.length;i++){var l=b[i],s=l.getAttribute("title");if(s=s?s.trim():"",!s)break;l.setAttribute("data-tooltip",s),l.setAttribute("title","")}this.instance.on("storage:load",function(t){console.log("Loaded ",t)}),this.instance.on("storage:store",function(t){console.log("Stored ",t)}),this.instance.on("load",function(){var t=grapesjs.$;e.getButton("options","sw-visibility").set({command:"core:component-outline",active:!0});var a=e.getButton("views","open-tm");a&&a.set("active",1);var n=e.getButton("views","open-sm");n&&n.set("active",1),e.removeButton("views","open-tm");var r=t('<div class="gjs-sm-sector no-select"><div class="gjs-sm-sector-title"><span class="icon-settings fa fa-cog"></span> <span class="gjs-sm-sector-label">Settings</span></div><div class="gjs-sm-properties" style="display: none;"></div></div>'),h=r.find(".gjs-sm-properties");h.append(t(".gjs-traits-cs")),t(".gjs-sm-sectors").before(r),r.find(".gjs-sm-sector-title").on("click",function(){var c=h.get(0).style,S=c.display=="none";S?c.display="block":c.display="none"});var y=this.instance.Panels.getButton("views","open-blocks");y&&y.set("active",1)}),this.instance.on("update",t=>{var a=this.instance.getHtml({cleanId:!0}),n=a.match(/<body\b[^>]*>([\s\S]*?)<\/body>/);n?this.state=n[1]:this.state=this.instance.getHtml()})}}))});
