document.addEventListener("alpine:init",()=>{Alpine.data("grapesjs",({state:p,statePath:B,readOnly:k,tools:b,minHeight:y,container:d,plugins:u,settings:v})=>({instance:null,state:p,tools:b,plugins:u,settings:v,init(){let E={};var h=document.querySelector("[id='css']")??null;let j={height:y+"px",container:d||".filament-grapesjs .grapesjs-wrapper",showOffsets:!0,fromElement:!0,noticeOnUnload:!1,storageManager:!1,loadHtml:p,style:h.value,plugins:u,selectorManager:{escapeName:e=>e},...v};var t=grapesjs.init(j),o=t.Panels,A=t.Modal,w=t.Commands;w.add("canvas-clear",function(){confirm("Are you sure to clean the canvas?")&&(t.runCommand("core:canvas-clear"),setTimeout(function(){localStorage.clear()},0))}),[["sw-visibility","Show Borders"],["preview","Preview"],["fullscreen","Fullscreen"],["export-template","Export"],["undo","Undo"],["redo","Redo"],["gjs-open-import-webpage","Import"],["canvas-clear","Clear canvas"]].forEach(function(e){btn=o.getButton("options",e[0]),btn&&btn.set("attributes",{title:e[1],"data-tooltip-pos":"bottom"})}),[["open-sm","Style Manager"],["open-layers","Layers"],["open-blocks","Blocks"]].forEach(function(e){o.getButton("views",e[0]).set("attributes",{title:e[1],"data-tooltip-pos":"bottom"})});for(var g=document.querySelectorAll("*[title]"),r=0;r<g.length;r++){var i=g[r],a=i.getAttribute("title");if(a=a?a.trim():"",!a)break;i.setAttribute("data-tooltip",a),i.setAttribute("title","")}t.on("storage:load",function(e){console.log("Loaded ",e)}),t.on("storage:store",function(e){console.log("Stored ",e)}),t.on("load",function(){var e=grapesjs.$;o.getButton("options","sw-visibility").set({command:"core:component-outline",active:!0});var s=o.getButton("views","open-tm");s&&s.set("active",1);var n=o.getButton("views","open-sm");n&&n.set("active",1),o.removeButton("views","open-tm");var l=e('<div class="gjs-sm-sector no-select"><div class="gjs-sm-sector-title"><span class="icon-settings fa fa-cog"></span> <span class="gjs-sm-sector-label">Settings</span></div><div class="gjs-sm-properties" style="display: none;"></div></div>'),m=l.find(".gjs-sm-properties");m.append(e(".gjs-traits-cs")),e(".gjs-sm-sectors").before(l),l.find(".gjs-sm-sector-title").on("click",function(){var c=m.get(0).style,S=c.display=="none";S?c.display="block":c.display="none"});var f=t.Panels.getButton("views","open-blocks");f&&f.set("active",1)}),t.on("update",e=>{var s=t.getHtml({cleanId:!0}),n=s.match(/<body\b[^>]*>([\s\S]*?)<\/body>/);n?this.state=n[1]:this.state=t.getHtml()}),t.on("change",e=>{var s=document.querySelector("[id='css']")??null;s&&(s.value=t.getCss(),s.dispatchEvent(new Event("input")))})}}))});
